Na\_2022\_DerivativePBFT
Title:: A derivative PBFT blockchain consensus algorithm with dual primary nodes based on separation of powers-DPNPBFT
Citekey:: Na\_2022\_DerivativePBFT
Author:: Yanhe Na; Zhan Wen; Jie Fang; Yin Tang; Yingxiang Li
Date:: 2022-07-19
Journal:: IEEE Access
Tags:: #PBFT #双主节点 #主节点选择优化 
File:: [Na 等\_2022\_A Derivative PBFT Blockchain Consensus Algorithm With Dual P.pdf](zotero://open-pdf/0_P4Q95CWT)
Work:: 本文提出了一种基于权力分离的双主节点PBFT派生算法（DPNPBFT）。该算法通过选择两个主节点进行相互监督和制衡，避免单一主节点系统的过度集中化，并减少副本节点的通信复杂度​​。
## 研究背景
区块链共识算法是区块链系统中至关重要的部分，类似于国家的法律。现有的共识算法，如比特币的工作量证明（PoW）和以太坊的权益证明（PoS），虽然在公链中被广泛应用，但存在高能耗和效率低下的问题​​。与之相比，PBFT（实用拜占庭容错）算法在保证节点一致性和安全性方面具有优势，但其高通信复杂度限制了其在大规模节点场景中的应用。
## 研究目的
本研究旨在提出一种改进的PBFT共识算法，通过引入双主节点机制，以实现系统安全性、通信复杂度和故障容忍率之间的最佳平衡。具体目标包括提高系统的容错能力，降低通信复杂度，并确保在大规模物联网应用场景中的高效性能​​。
## 研究技术
本文提出了一种基于权力分离的双主节点PBFT派生算法（DPNPBFT）。该算法通过选择两个主节点进行相互监督和制衡，避免单一主节点系统的过度集中化，并减少副本节点的通信复杂度​​。
## 研究内容
**算法架构**
双主节点机制：该算法通过引入两个主节点（P1和P2），来实现权力分离和相互监督。P1负责消息的广播，P2负责消息的验证 。
**双选择节点**
![\<img alt="" data-attachment-key="ANRJA6U2" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F10122808%2Fitems%2FP4Q95CWT%22%2C%22annotationKey%22%3A%22T38PLE9V%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%2276116%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B303.932%2C345.231%2C491.705%2C433.996%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F10122808%2Fitems%2FZ85YZ8SY%22%5D%2C%22locator%22%3A%2276116%22%7D%7D" width="313" height="148" src="05-附件/ANRJA6U2.png" ztype="zimage">](05-附件/ANRJA6U2.png)
**共识流程**
1.  请求阶段：客户端将请求消息同时发送给P1和P2节点
2.  预准备阶段：P1广播预准备消息给所有副本节点（不包括P2）。副本节点验证消息后，发送检查消息给P2
3.  检查阶段：P2在预设的全局稳定时间（GST）内，接收副本节点发送的检查消息，并验证其正确性。如果接收到的有效检查消息达到f+2（不包括自身），则向所有节点广播提交消息
4.  提交阶段：所有节点接收P2的提交消息后，在GST到期后进行验证。如果验证通过，则将消息写入本地区块链，并向客户端发送回复消息
5.  完成阶段：客户端接收到f+2的回复消息后，广播完成消息。未收到消息的节点在接收到完成消息后，强制写入本地区块链，并准备进入下一个共识循环
**容错分析**
1\. 容错率
当节点总数为奇数时，2f + 3 = N
当节点总数为偶数时，2f + 2 = N
统一为f = \[(N - 2) / 2]，其中f表示拜占庭节点数，N表示节点总数
2\. 不同故障情况的处理
副本节点故障：
如果副本节点故障（包括不回复或发送错误消息），P2节点在收到f+2个有效检查消息后，仍能正常达成共识
P1节点故障：
如果P1节点宕机或部分发送消息，P2节点在提交阶段未能收到足够的回复消息时，将发送重新选举消息，启动视图切换
如果P1节点发送不同的消息，P2节点在提交阶段未能满足f+2条件时，发送重新选举消息，启动视图切换
P2节点故障：
如果P2节点宕机，P1节点在提交阶段未收到P2的提交消息后，将发送重新选举消息，启动视图切换
如果P2节点部分发送消息，视具体情况处理：如果P1节点在提交阶段未收到P2消息，则发送重新选举消息，启动视图切换
P1和P2节点同时宕机：
客户端在GST后发送重新选举消息，各节点验证后启动视图切换
## 实验结果
通过实验比较DPNPBFT与传统PBFT和其他派生算法在通信复杂度、TPS（每秒交易数）等方面的性能​​。
DPNPBFT在通信复杂度上达到了O(N)级别，显著低于传统PBFT算法，同时在1700 TPS下表现稳定。与单主节点PBFT派生算法相比，DPNPBFT在安全性和综合性能上表现最佳​​。
## 未来与展望
未来研究方向包括进一步优化DPNPBFT算法，以适应更大规模的区块链应用场景，并探讨其在其他领域中的潜在应用。此外，还可以研究如何进一步提高算法的容错能力和安全性​​。
